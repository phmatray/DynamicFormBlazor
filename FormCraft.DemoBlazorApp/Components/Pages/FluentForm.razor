@page "/fluent"
@inject FormCodeGeneratorService CodeGenerator

<DemoPageLayout
    Title="Fluent API Dynamic Form"
    Icon="@Icons.Material.Filled.FlashOn"
    Description="This demonstrates the fluent API with helper methods for common field types and streamlined form building."
    FormDemoIcon="@Icons.Material.Filled.ContactPage">
    <FormDemoContent>
        <FormDemoSection
            TModel="ContactModel"
            Model="@_model"
            Configuration="@_formConfiguration"
            FormTitle="Contact Information Form"
            FormIcon="@Icons.Material.Filled.Assignment"
            IsSubmitted="@_isSubmitted"
            IsSubmitting="@_isSubmitting"
            OnValidSubmit="@HandleValidSubmit"
            OnFieldChanged="@((args) => HandleFieldChanged(args.fieldName, args.value))"
            OnReset="@ResetForm"
            DataDisplayItems="@GetDataDisplayItems()"
            ShowSubmitButton="true"
            SubmitButtonText="Submit Information"
            SubmittingText="Submitting..."
            SubmitButtonClass="px-8">
            <SidebarContent>
                <FormGuidelines Guidelines="@_sidebarFeatures" Title="Fluent API Features" />
            </SidebarContent>
            <AdditionalContent>
                @if (_fieldChanges.Any())
                {
                    <MudCard Class="mt-4" Elevation="2">
                        <MudCardContent>
                            <MudText Typo="Typo.h6" GutterBottom="true" Class="d-flex align-items-center">
                                <MudIcon Icon="@Icons.Material.Filled.Timeline" Class="me-2 text-info" />
                                Field Changes Log
                            </MudText>
                            <MudList T="string" Dense="true">
                                @foreach (var change in _fieldChanges.TakeLast(5))
                                {
                                    <MudListItem T="string" Icon="@Icons.Material.Filled.Update" IconColor="Color.Secondary">
                                        <MudText Typo="Typo.body2">@change</MudText>
                                    </MudListItem>
                                }
                            </MudList>
                        </MudCardContent>
                    </MudCard>
                }
            </AdditionalContent>
        </FormDemoSection>
    </FormDemoContent>
    
    <CodeExampleContent>
        <CodeExample
            Title="Fluent API Configuration"
            Language="csharp"
            Code="@GetGeneratedCode()" />
    </CodeExampleContent>
    
    <GuidelinesContent>
        <ApiGuidelinesTable
            Title="Fluent API Guidelines"
            Items="@_apiGuidelineTableItems" />
    </GuidelinesContent>
</DemoPageLayout>